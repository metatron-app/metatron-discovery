<!--
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div class="ddp-type-contents3">
  <!-- top -->
  <style>
    .ddp-type-selectbox ul.ddp-list-selectbox li a:hover {background:none;}
  </style>
  <div class="ddp-top-flow">
    <!-- navi wrap -->
    <div class="ddp-wrap-naviarea ddp-editnavi ddp-clear">
      <em class="ddp-icon-dataset2"></em>
      <div class="ddp-ui-naviarea">
        <!-- name -->
        <!-- 클릭시 ddp-selected 추가 -->
        <div class="ddp-wrap-naviname" [ngClass]="{'ddp-selected':isOtherDatasetListShow}" (click)="showDatasets()" (clickOutside)="isOtherDatasetListShow = false">
          <span class="ddp-data-naviname">{{selectedDataSet.dsName}}<em class="ddp-icon-menuview"></em>
          </span>
          <!-- popup -->
          <div class="ddp-wrap-popup2 ddp-type">
            <div class="ddp-ui-label ">
              {{'msg.dp.ui.num.ds.flow' | translate : {value:dataflow['wrangledDsCount']} }}
            </div>

            <ul class="ddp-list-popup ddp-list-dataset">
              <li [ngClass]="{'ddp-selected': dataset.current}" *ngFor="let dataset of filteredWrangledDatasets">
                <a href="javascript:" (click)="changeWrangledDataset(dataset)">
                  <em class="ddp-icon-dataset3"></em>
                  <span class="ddp-data-name">{{dataset.dsName}}</span>
                </a>
              </li>
            </ul>
          </div>
          <!-- //popup -->
        </div>
        <!-- //name -->


      </div>

      <div class="ddp-ui-navibuttons">
        <a href="javascript:" class="ddp-btn-buttons2" (click)="createSnapshot()"><em class="ddp-icon-shot"></em>{{'msg.dp.th.ss' | translate}}</a>
        <a href="javascript:" class="ddp-btn-line3" (click)="prev();"><em class="ddp-icon-btndone"></em>{{'msg.comm.btn.done' | translate}}</a>
      </div>
    </div>
    <!-- //navi wrap -->
  </div>

  <!-- //top -->
  <!--</vertical-split-pane>-->
  <div class="ddp-wrap-flow" style="position:fixed; left:0; top:48px; bottom:0; right:0; box-sizing:border-box; overflow:hidden;">
    <!--<div class="ddp-ui-bar-right" ></div>-->
    <!--<div class="ddp-ui-bar-bottom" ></div>-->


    <div style="height: 100%;">
      <horizontal-split-pane #box1 primary-component-minsize="70" secondary-component-minsize="30"  primary-component-initialratio="0.7">
        <!--(on-change)="onHChange($event)"-->
        <div class="split-pane-content-secondary" style=" height:100%; background-color:#fff;">
          <div class="lower" style="height:100%;">

            <!-- add rule -->
            <div class="ddp-wrap-addrule" style="position:relative; top:0; left:0; right:0; bottom:0; height:inherit; min-height:inherit">
              <!-- 화면 클릭 오류로 인해 z-index를 임시로 설정함!!! 후에 정식으로 수정해야 함!! -->
              <div class="ddp-box-top" style="position:relative; top:0; left:0; right:0; bottom:0;z-index:10;">
                <!-- title -->
                <div class="ddp-box-title">
                  {{'msg.dp.ui.add.rule.title' | translate}}
                  <a href="javascript:" class="ddp-link-switch" (click)="switchEditor()">{{editorUseLabel}}</a>
                </div>
                <!-- //title -->
                <!-- buttons -->
                <div class="ddp-ui-buttons">
                  <a href="javascript:" class="ddp-btn-type3" (click)="jump(ruleList.length-1, true); ruleVO.command = ''; selectedColumns = []; editColumnList = [];">{{'msg.comm.btn.cancl' | translate}}</a>
                  <a href="javascript:" class="ddp-btn-type4" (click)="addRule()">{{editLabelBtn}}</a>
                </div>
                <!-- //buttons -->
              </div>
              <div class="ddp-wrap-rulecontents"
                   [ngClass]="{'ddp-inherit': isCommandListShow || isColumnListShow || isTypeListShow || isMultiColumnListShow || isBeforeOrAfterShow || isBeforeOrAfterColumnListShow || isTooltipShow || isMultiColumnGroupListShow || isNestListShow || isFocus || isTimestampOpen}">
                <div class="ddp-box-contents ddp-clear">
                  <!-- editor -->
                  <div class="ddp-wrap-switch-editor" style="display:block" *ngIf="editorUseFlag === true">
                    <!-- switch 클릭시 ddp-box-full 추가 -->
                    <div class="ddp-box-command ddp-box-full">
                      <div class="ddp-ui-title">
                        {{'msg.dp.th.command' | translate}}
                      </div>

                      <!-- input -->
                      <div class="ddp-wrap-datainput">
                        <input type="text" class="ddp-input-typebasic" placeholder="{{'msg.dp.alert.command.input.ph' | translate}}" [(ngModel)]="inputRuleCmd" >
                      </div>
                      <!-- //input -->
                    </div>
                  </div>
                  <!-- //editor -->

                  <!-- builder -->
                  <div class="ddp-wrap-switch-builder" style="display:block" *ngIf="editorUseFlag === false">
                    <div class="ddp-box-command">
                      <div class="ddp-ui-title">
                        {{'msg.dp.th.command' | translate}}
                      </div>
                      <!-- select box -->
                      <!-- 클릭시 ddp-selected 추가 -->
                      <div class="ddp-type-selectbox ddp-type-search-select"
                           tabindex="1"
                           [ngClass]="{'ddp-selected' : isCommandListShow}"
                           [class.ddp-result]="ruleVO.command"
                           (click)="showCommandList($event)"
                           (keydown)="navigateWithKeyboardShortList($event, filteredCommandList, 'command')">
                        <!-- 선택시 자동 input display:block; -->
                        <input type="text" class="ddp-input-selectbox" placeholder="{{'msg.dp.th.command' | translate}}" [(ngModel)]="commandSearchText" id="commandSearch">
                        <span class="ddp-txt-selectbox" >{{ruleVO.command !== '' ?  ruleVO.command : 'msg.dp.ui.command.input.ph' | translate }}</span>
                        <ul class="ddp-list-selectbox ddp-list-command"
                            *ngIf="isCommandListShow"
                            (clickOutside)="isCommandListShow = false; initSelectedCommand(filteredCommandList)">
                          <li *ngFor="let command of filteredCommandList; let index = index;"
                              (click)="selectCommand($event, command)"
                              (mouseout)="commandListHover($event,index)"
                              (mouseover)="commandListHover($event,index)"
                              (mousemove)="flag === true ? flag = false : flag = true">
                            <a href="javascript:" [ngStyle]="command.isHover ? {'background-color': '#f6f6f7' }:{}">
                              <span class="ddp-ui-type">
                                <em class="ddp-ui-round">{{command.alias}}</em>{{command.command}}
                              </span>
                              <span class="ddp-ui-code">
                                {{command.desc}}
                              </span>
                            </a>
                          </li>
                          <li *ngIf="filteredCommandList.length ===0"><span class="ddp-noresult">{{'msg.dp.ui.search.no.rslt' | translate}}</span></li>
                        </ul>
                      </div>
                      <!-- //select box -->
                    </div>
                    <div class="ddp-wrap-part" *ngIf="ruleVO.command !== ''">

                      <!--startHeader-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'header'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.row' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" tabindex="2" class="ddp-input-typebasic" placeholder="{{'msg.dp.th.row.ph' | translate}}" [(ngModel)]="ruleVO.rownum" [input-mask]="'number'">
                        </div>
                      </div>
                      <!-- //part -->
                      <!-- //endHeader-->


                      <!--startKeep-->
                      <!-- part -->
                      <div class="ddp-box-part ddp-editor" *ngIf="ruleVO.command === 'keep'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.condition' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <div class="ddp-wrap-input-info" [ngClass]="{'ddp-selected':isFocus}" (clickOutside)="isAutoCompleteSuggestionListOpen=false">
                            <input type="text" id="rule-keep-input" tabindex="2" class="ddp-input-typebasic" placeholder="{{'msg.dp.th.condition.ph' | translate}}" [(ngModel)]="ruleVO.row" (focus)="isFocus=true;changeRule($event)" (blur)="isFocus=false" (click)="changeRule($event)" (keydown)="changeRule($event)" (paste)="changeRule($event)">
                            <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isAutoCompleteSuggestionListOpen" >
                              <li *ngFor="let item of autoCompleteSuggestions;let idx=index" (click)="onautoCompleteSuggestionsSelect(item)">
                                <a [ngStyle]="idx==autoCompleteSuggestions_selectedIdx?{'background-color':'#f6f6f7','color':item.class}:{'color':item.class}" href="javascript:">
                                  {{item.value}}
                                </a>
                              </li>
                              <li *ngIf="autoCompleteSuggestions.length === 0">
                                <span class="ddp-noresult">
                                  {{'msg.dp.ui.search.no.rslt' | translate}}
                                </span>
                              </li>
                            </ul>
                          </div>
                        </div>
                        <a href="javascript:" class="ddp-btn-bg" (click)="openPopupFormulaInput('keep')"><em class="ddp-icon-editor"></em>Advanced editor</a>
                      </div>
                      <!-- //part -->
                      <!-- //endKeep-->

                      <!--startReplace-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'replace'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-selected" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox"></i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'replace'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.pattern' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-type-multy2 ddp-clear">
                          <!-- box scroll -->
                          <div class="ddp-wrap-box-info"[ngClass]="{'ddp-selected':isFocus}" >
                            <div class="ddp-box-info">
                              <div class="ddp-box-info-in">
                                <span class="ddp-input-title">{{'Patterns' | translate}}</span>
                                {{'msg.dp.ui.pattern.description' | translate}}<br>

                                <strong class="ddp-ex">{{'msg.dp.ui.examples' | translate}}</strong>
                                {{'msg.dp.ui.string' | translate}}<br>
                                <i style="color:darkgrey">'Seoul'</i><br><br>

                                {{'msg.dp.ui.reg.ex' | translate}}<br>
                                <i style="color:darkgrey">/(\d)+/</i><br><br>
                              </div>
                            </div>
                            <div class="ddp-wrap-boxwrap">
                              <input type="text" tabindex="3" class="ddp-input-typebasic" placeholder="{{ 'msg.dp.th.pattern.ph' | translate }}" [(ngModel)]="ruleVO.on" (focus)="isFocus = true" (blur)="isFocus=false">
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'replace'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.new.value' | translate}}
                        </div>
                        <!-- info -->
                        <div class="ddp-ui-info">
                          <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                          <div class="ddp-box-info">
                            {{'msg.dp.th.new.value.description' | translate}}
                          </div>
                        </div>
                        <!-- //info -->

                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="4" placeholder="{{'msg.dp.th.new.value.ph' | translate}}" [(ngModel)]="ruleVO.with">
                          <!-- ddp-selected 추가시 display:block; -->
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'replace'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.quote' | translate}}
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="5" placeholder="{{'msg.dp.ui.enter.value' | translate}}" [(ngModel)]="ruleVO.quote">
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'replace'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.match.occur' | translate}}
                        </div>

                        <ul class="ddp-list-buttons">
                          <li [ngClass]="{'ddp-selected':ruleVO.global}" (click)="ruleVO.global = true;">
                            {{'msg.dp.ui.yes' | translate}}
                          </li>
                          <li [ngClass]="{'ddp-selected':!ruleVO.global}" (click)="ruleVO.global = false;">
                            {{'msg.dp.ui.no' | translate}}
                          </li>
                        </ul>
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'replace'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.ignore.case' | translate}}
                        </div>

                        <ul class="ddp-list-buttons">
                          <li [ngClass]="{'ddp-selected':ruleVO.ignoreCase}" (click)="ruleVO.ignoreCase = true;">
                            {{'msg.dp.ui.yes' | translate}}
                          </li>
                          <li [ngClass]="{'ddp-selected':!ruleVO.ignoreCase}" (click)="ruleVO.ignoreCase = false;">
                            {{'msg.dp.ui.no' | translate}}
                          </li>
                        </ul>
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'replace'">
                        <div class="ddp-box-title">
                          {{'msg.dp.ui.cond' | translate}}
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="6" placeholder="{{'msg.dp.ui.cond.ph' | translate}}" [(ngModel)]="ruleVO.row">
                          <!-- ddp-selected 추가시 display:block; -->
                        </div>
                      </div>
                      <!--//part-->
                      <!-- //endReplace-->


                      <!--startRename-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'rename'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->

                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-type-search-select" tabindex="2"
                             [ngClass]="{'ddp-selected':isColumnListShow}"
                             [class.ddp-result]="ruleVO.col"
                             (click)="showColumnList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, filteredColumnList, 'column1')">
                          <input type="text" class="ddp-input-selectbox columnSearch" placeholder="{{'msg.dp.ui.column.search.description' | translate}}" [(ngModel)]="columnSearchText">
                          <span class="ddp-txt-selectbox">{{ruleVO.col ? ruleVO.col : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isColumnListShow" (clickOutside)="isColumnListShow = false;">
                            <li *ngFor="let col of filteredColumnList; let index = index;"
                                (click)="selectColumn($event, col)"
                                (mouseover)="listMouseOver($event, 'column1', index)"
                                (mouseout)="listMouseOut($event, 'column1')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="col.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{col.name}}
                              </a>
                            </li>
                            <li *ngIf="filteredColumnList.length === 0">
                              <span class="ddp-noresult">
                                {{'msg.dp.ui.search.no.rslt' | translate}}
                              </span>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part ddp-editor" *ngIf="ruleVO.command === 'rename'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.new-column-name' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic newColumnInput" tabindex="3" placeholder="{{'msg.dp.th.new-column-name.ph' | translate}}" [(ngModel)]="ruleVO.to" >
                        </div>
                        <a href="javascript:" class="ddp-btn-bg" (click)="onMulticolumnRenameClick()">{{ 'msg.dp.btn.multiple.col' | translate }}</a>
                      </div>
                      <!-- //part -->
                      <!-- //endRename-->

                      <!--startSet-->
                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'set'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}
                          <em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <div class="ddp-type-selectbox ddp-selected" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox"></i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->
                      <!-- part -->
                      <div class="ddp-box-part ddp-editor" *ngIf="ruleVO.command === 'set'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.val' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <div class="ddp-wrap-input-info" [ngClass]="{'ddp-selected':isFocus}" (clickOutside)="isAutoCompleteSuggestionListOpen=false">
                            <input type="text" id="rule-set-input" class="ddp-input-typebasic" tabindex="3" placeholder="{{'msg.dp.alert.insert.formula' | translate}}" [(ngModel)]="ruleVO.value" (focus)="isFocus=true;changeRule($event)" (blur)="isFocus=false" (click)="changeRule($event)" (keydown)="changeRule($event)" (paste)="changeRule($event)">
                            <ul class="ddp-list-selectbox ddp-list-command" style="width:278px;"  *ngIf="isAutoCompleteSuggestionListOpen">
                              <li *ngFor="let item of autoCompleteSuggestions;let idx=index" (click)="onautoCompleteSuggestionsSelect(item)">
                                <a [ngStyle]="idx==autoCompleteSuggestions_selectedIdx?{'background-color':'#f6f6f7','color':item.class}:{'color':item.class}" href="javascript:">
                                  {{item.value}}
                                </a>
                              </li>
                              <li *ngIf="autoCompleteSuggestions.length === 0">
                                <span class="ddp-noresult">
                                  {{'msg.dp.ui.search.no.rslt' | translate}}
                                </span>
                              </li>
                            </ul>
                            <a href="javascript:" class="ddp-btn-bg" (click)="openPopupFormulaInput('set')"><em class="ddp-icon-editor"></em>Advanced editor</a>
                          </div>
                        </div>
                      </div>
                      <!-- //part -->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'set'">
                        <div class="ddp-box-title">
                          {{'msg.dp.ui.cond' | translate}}
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="6" placeholder="{{'msg.dp.ui.cond.ph' | translate}}" [(ngModel)]="ruleVO.row">
                          <!-- ddp-selected 추가시 display:block; -->
                        </div>
                      </div>
                      <!--//part-->
                      <!--//endSet-->

                      <!--startSettype-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'settype'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <div class="ddp-type-selectbox ddp-selected" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox"></i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'settype'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.new.type' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-type-search-select" tabindex="3"
                             [ngClass]="{'ddp-selected':isTypeListShow}"
                             [class.ddp-result]="ruleVO.type"
                             (click)="showTypeList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, filteredTypeList, 'type')">
                          <input type="text" class="ddp-input-selectbox type-search" placeholder="Search by type" [(ngModel)]="typeSearchText">
                          <span class="ddp-txt-selectbox">{{ruleVO.type ? ruleVO.type : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isTypeListShow" (clickOutside)="isTypeListShow = false; typeSearchText = ''; initSelectedCommand(filteredTypeList)">
                            <li *ngFor="let type of filteredTypeList; let index=index"
                                (click)="setColumnType($event, type)"
                                (mouseover)="listMouseOver($event, 'type', index)"
                                (mouseout)="listMouseOut($event, 'type')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="type.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{type.name}}
                              </a>
                            </li>
                            <li *ngIf="filteredTypeList.length === 0">
                              <span class="ddp-noresult">
                                {{'msg.dp.ui.search.no.rslt' | translate}}
                              </span>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'settype' && isTypeTimestamp" style = "width :260px">
                        <div class="ddp-box-title">
                          {{'msg.dp.ui.set.pattern' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-type-search-select" tabindex="4"
                             [ngClass]="{'ddp-selected':isTimestampOpen}"
                             [class.ddp-result]="ruleVO.timestamp"
                             (click)="showTimestampList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, timestampTime, 'timestamp')">
                          <!--<input type="text" class="ddp-input-selectbox type-search" placeholder="Enter timestamp format" [ngModel]="ruleVO.timestamp">-->
                          <span class="ddp-txt-selectbox">{{ruleVO.timestamp ? ruleVO.timestamp : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isTimestampOpen" (clickOutside)="isTimestampOpen = false; typeSearchText = ''; initSelectedCommand(timestampTime);">
                            <li *ngFor="let time of timestampTime; let index=index"
                                (click)="setTimestamp($event, time)"
                                (mouseover)="listMouseOver($event, 'timestamp', index)"
                                (mouseout)="listMouseOut($event, 'timestamp')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="time.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{time.name}}
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'settype' && ruleVO.timestamp === 'Custom format'">
                        <div class="ddp-box-title">
                          {{'msg.dp.ui.custom.format' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic newColumnInput" tabindex="5" placeholder="{{'msg.dp.ui.timestamp.ph' | translate}}" [(ngModel)]="timestampVal">
                        </div>
                      </div>
                      <!-- //part -->
                      <!--//endSettype-->

                      <!--startCountpattern-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'countpattern'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>

                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-selected" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox"></i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'countpattern'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.pattern' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-type-multy2 ddp-clear">
                          <!-- box scroll -->
                          <div class="ddp-wrap-box-info"[ngClass]="{'ddp-selected':isFocus}" >
                            <div class="ddp-box-info">
                              <div class="ddp-box-info-in">
                                <span class="ddp-input-title">{{'Patterns' | translate}}</span>
                                {{'msg.dp.ui.pattern.description' | translate}}<br>

                                <strong class="ddp-ex">{{'msg.dp.ui.examples' | translate}}</strong>
                                {{'msg.dp.ui.string' | translate}}<br>
                                <i style="color:darkgrey">'Seoul'</i><br><br>

                                {{'msg.dp.ui.reg.ex' | translate}}<br>
                                <i style="color:darkgrey">/(\d)+/</i><br><br>
                              </div>
                            </div>
                            <div class="ddp-wrap-boxwrap">
                              <input type="text" tabindex="3" class="ddp-input-typebasic" placeholder="{{ 'msg.dp.th.pattern.ph' | translate }}" [(ngModel)]="ruleVO.on" (focus)="isFocus = true" (blur)="isFocus=false">
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'countpattern'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.quote' | translate}}
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="6" placeholder="{{'msg.dp.ui.enter.value' | translate}}" [(ngModel)]="ruleVO.quote">
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'countpattern'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.ignore.case' | translate}}
                        </div>

                        <ul class="ddp-list-buttons">
                          <li [ngClass]="{'ddp-selected':!ruleVO.ignoreCase}" (click)="ruleVO.ignoreCase = false">
                            {{'msg.dp.ui.no' | translate}}
                          </li>
                          <li [ngClass]="{'ddp-selected':ruleVO.ignoreCase}" (click)="ruleVO.ignoreCase = true">
                            {{'msg.dp.ui.yes' | translate}}
                          </li>
                        </ul>
                      </div>
                      <!-- //part -->
                      <!--//endCountpattern-->

                      <!--startSplit-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'split'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-type-search-select"
                             tabindex="2"
                             [ngClass]="{'ddp-selected':isColumnListShow}"
                             [class.ddp-result]="ruleVO.col"
                             (click)="showColumnList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, filteredColumnList, 'column1')">
                          <input type="text" class="ddp-input-selectbox columnSearch" placeholder="{{'msg.dp.ui.column.search.description' | translate}}" [(ngModel)]="columnSearchText">
                          <span class="ddp-txt-selectbox">{{ruleVO.col ? ruleVO.col : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isColumnListShow" (clickOutside)="isColumnListShow = false; initSelectedCommand(filteredColumnList);">
                            <li *ngFor="let col of filteredColumnList; let index = index;"
                                (click)="selectColumn($event, col)"
                                (mouseover)="listMouseOver($event, 'column1', index)"
                                (mouseout)="listMouseOut($event, 'column1')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="col.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{col.name}}
                              </a>
                            </li>
                            <li *ngIf="filteredColumnList.length === 0">
                              <span class="ddp-noresult">
                                {{'msg.dp.ui.search.no.rslt' | translate}}
                              </span>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'split'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.pattern' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-type-multy2 ddp-clear">
                          <!-- box scroll -->
                          <div class="ddp-wrap-box-info"[ngClass]="{'ddp-selected':isFocus}" >
                            <div class="ddp-box-info">
                              <div class="ddp-box-info-in">
                                <span class="ddp-input-title">{{'Patterns' | translate}}</span>
                                {{'msg.dp.ui.pattern.description' | translate}}<br>

                                <strong class="ddp-ex">{{'msg.dp.ui.examples' | translate}}</strong>
                                {{'msg.dp.ui.string' | translate}}<br>
                                <i style="color:darkgrey">'Seoul'</i><br><br>

                                {{'msg.dp.ui.reg.ex' | translate}}<br>
                                <i style="color:darkgrey">/(\d)+/</i><br><br>
                              </div>
                            </div>
                            <div class="ddp-wrap-boxwrap">
                              <input type="text" tabindex="3" class="ddp-input-typebasic" placeholder="{{ 'msg.dp.th.pattern.ph' | translate }}" [(ngModel)]="ruleVO.on" (focus)="isFocus = true" (blur)="isFocus=false">
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'split'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.num.times' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" tabindex="5" class="ddp-input-typebasic" placeholder="{{'msg.dp.th.num.times.ph' | translate}}" [(ngModel)]="ruleVO.limit" [input-mask]="'number'">
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'split'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.quote' | translate}}
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="6" placeholder="{{'msg.dp.ui.enter.value' | translate}}" [(ngModel)]="ruleVO.quote">
                        </div>
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'split'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.ignore.case' | translate}}
                        </div>
                        <ul class="ddp-list-buttons">
                          <li [ngClass]="{'ddp-selected':!ruleVO.ignoreCase}" (click)="ruleVO.ignoreCase = false;">
                            {{'msg.dp.ui.no' | translate}}
                          </li>
                          <li [ngClass]="{'ddp-selected':ruleVO.ignoreCase}" (click)="ruleVO.ignoreCase = true;">
                            {{'msg.dp.ui.yes' | translate}}
                          </li>
                        </ul>
                      </div>
                      <!-- //part -->
                      <!--//endSplit-->

                      <!--startDerive-->
                      <!-- part -->
                      <div class="ddp-box-part ddp-editor" *ngIf="ruleVO.command === 'derive'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.val' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <div class="ddp-wrap-input-info" [ngClass]="{'ddp-selected':isFocus}" (clickOutside)="isAutoCompleteSuggestionListOpen=false">
                            <input type="text" id="rule-derive-input" class="ddp-input-typebasic" tabindex="2" placeholder="{{'msg.dp.alert.insert.formula' | translate}}" [(ngModel)]="ruleVO.value" (focus)="isFocus=true;changeRule($event)" (blur)="isFocus=false" (click)="changeRule($event)" (keydown)="changeRule($event)" (paste)="changeRule($event)">
                            <ul class="ddp-list-selectbox ddp-list-command" style="width:278px;" *ngIf="isAutoCompleteSuggestionListOpen" >
                              <li *ngFor="let item of autoCompleteSuggestions;let idx=index" (click)="onautoCompleteSuggestionsSelect(item)">
                                <a [ngStyle]="idx==autoCompleteSuggestions_selectedIdx?{'background-color':'#f6f6f7','color':item.class}:{'color':item.class}" href="javascript:">
                                  {{item.value}}
                                </a>
                              </li>
                              <li *ngIf="autoCompleteSuggestions.length === 0">
                                <span class="ddp-noresult">
                                  {{'msg.dp.ui.search.no.rslt' | translate}}
                                </span>
                              </li>
                            </ul>
                            <a href="javascript:" class="ddp-btn-bg" (click)="openPopupFormulaInput('derive')"><em class="ddp-icon-editor"></em>Advanced editor</a>
                          </div>
                        </div>
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div *ngIf="ruleVO.command === 'derive'" class="ddp-box-part" style="padding : 0 35px;" >
                        <div class="ddp-box-title">
                          {{'msg.dp.th.new-column-name' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- info -->
                        <div class="ddp-ui-info">
                          <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                          <div class="ddp-box-info">
                            {{'msg.dp.ui.derive.tooltip' | translate}}
                          </div>
                        </div>
                        <!-- //info -->

                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="3" placeholder="{{'msg.dp.th.new-column-name.ph' | translate}}" [(ngModel)]="ruleVO.as">
                        </div>
                      </div>
                      <!-- //part -->
                      <!--//endDerive-->

                      <!--startDelete-->
                      <!-- part -->
                      <div class="ddp-box-part ddp-editor" *ngIf="ruleVO.command === 'delete'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.condition' | translate}}<em class="ddp-icon-essential"></em>
                        </div>

                        <div class="ddp-wrap-datainput">
                          <div class="ddp-wrap-input-info" [ngClass]="{'ddp-selected':isFocus}" (clickOutside)="isAutoCompleteSuggestionListOpen=false">
                            <input type="text" id="rule-delete-input" tabindex="2" class="ddp-input-typebasic" placeholder="{{'msg.dp.th.condition.ph' | translate}}" [(ngModel)]="ruleVO.row" (focus)="isFocus=true;changeRule($event)" (blur)="isFocus=false" (click)="changeRule($event)" (keydown)="changeRule($event)" (paste)="changeRule($event)">
                            <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isAutoCompleteSuggestionListOpen" >
                              <li *ngFor="let item of autoCompleteSuggestions;let idx=index" (click)="onautoCompleteSuggestionsSelect(item)">
                                <a [ngStyle]="idx==autoCompleteSuggestions_selectedIdx?{'background-color':'#f6f6f7','color':item.class}:{'color':item.class}" href="javascript:">
                                  {{item.value}}
                                </a>
                              </li>
                              <li *ngIf="autoCompleteSuggestions.length === 0">
                                <span class="ddp-noresult">
                                  {{'msg.dp.ui.search.no.rslt' | translate}}
                                </span>
                              </li>
                            </ul>

                            <!-- info -->
                            <!-- info box 잠시 숨김 -->
                            <!--
                            <div class="ddp-ui-info">
                              <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                              <div class="ddp-box-info">
                                <div class="ddp-box-info-in">
                                  <span class="ddp-input-title">{{'msg.dp.ui.tooltip.edit.pattern' | translate}}</span>
                                  {{'msg.dp.ui.delete.explain.title' | translate}}<br>

                                  <strong class="ddp-ex">{{'msg.dp.ui.examples' | translate}}</strong>
                                  if(columnName > 0)<br>
                                  <i style="color:darkgray">{{'msg.dp.ui.delete.explain.one' | translate}}</i><br><br>

                                  isnull(columnName)<br>
                                  <i style="color:darkgray">{{'msg.dp.ui.delete.explain.two' | translate}}</i><br><br>
                                </div>
                              </div>
                            </div>
                            -->
                            <!-- //info -->

                          </div>
                        </div>
                        <a href="javascript:" class="ddp-btn-bg" (click)="openPopupFormulaInput('delete')"><em class="ddp-icon-editor"></em>Advanced editor</a>

                      </div>
                      <!-- //part -->
                      <!--//endDelete-->


                      <!--startDrop-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'drop'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>

                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-selected" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox"></i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->
                      <!--//endDrop-->

                      <!--startExtract-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'extract'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-type-search-select"
                             [class.ddp-result]="ruleVO.col"
                             tabindex="2"
                             [ngClass]="{'ddp-selected':isColumnListShow}"
                             (click)="showColumnList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, filteredColumnList, 'column1')">
                          <input type="text" class="ddp-input-selectbox columnSearch" placeholder="{{'msg.dp.ui.column.search.description' | translate}}" [(ngModel)]="columnSearchText">
                          <span class="ddp-txt-selectbox">{{ruleVO.col ? ruleVO.col : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isColumnListShow" (clickOutside)="isColumnListShow = false; initSelectedCommand(filteredColumnList);">
                            <li *ngFor="let col of filteredColumnList; let index = index;"
                                (click)="selectColumn($event, col)"
                                (mouseover)="listMouseOver($event, 'column1', index)"
                                (mouseout)="listMouseOut($event, 'column1')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="col.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{col.name}}
                              </a>
                            </li>
                            <li *ngIf="filteredColumnList.length === 0">
                              <span class="ddp-noresult">
                                {{'msg.dp.ui.search.no.rslt' | translate}}
                              </span>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'extract'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.pattern' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-type-multy2 ddp-clear">
                          <!-- box scroll -->
                          <div class="ddp-wrap-box-info"[ngClass]="{'ddp-selected':isFocus}" >
                            <div class="ddp-box-info">
                              <div class="ddp-box-info-in">
                                <span class="ddp-input-title">{{'Patterns' | translate}}</span>
                                {{'msg.dp.ui.pattern.description' | translate}}<br>

                                <strong class="ddp-ex">{{'msg.dp.ui.examples' | translate}}</strong>
                                {{'msg.dp.ui.string' | translate}}<br>
                                <i style="color:darkgrey">'Seoul'</i><br><br>

                                {{'msg.dp.ui.reg.ex' | translate}}<br>
                                <i style="color:darkgrey">/(\d)+/</i><br><br>
                              </div>
                            </div>
                            <div class="ddp-wrap-boxwrap">
                              <input type="text" tabindex="3" class="ddp-input-typebasic" placeholder="{{ 'msg.dp.th.pattern.ph' | translate }}" [(ngModel)]="ruleVO.on" (focus)="isFocus = true" (blur)="isFocus=false">
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'extract'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.on.num.matches' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" tabindex="5" class="ddp-input-typebasic" placeholder="{{'msg.dp.ui.extract.ph' | translate}}" [(ngModel)]="ruleVO.limit" [input-mask]="'number'">
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'extract'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.quote' | translate}}
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="6" placeholder="{{'msg.dp.ui.enter.value' | translate}}" [(ngModel)]="ruleVO.quote">
                        </div>
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part ddp-box-s" *ngIf="ruleVO.command === 'extract'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.ignore.case' | translate}}
                        </div>
                        <ul class="ddp-list-buttons">
                          <li [ngClass]="{'ddp-selected':ruleVO.ignoreCase}" (click)="ruleVO.ignoreCase = true;">
                            {{'msg.dp.ui.yes' | translate}}
                          </li>
                          <li [ngClass]="{'ddp-selected':!ruleVO.ignoreCase}" (click)="ruleVO.ignoreCase = false;">
                            {{'msg.dp.ui.no' | translate}}
                          </li>
                        </ul>
                      </div>
                      <!-- //part -->
                      <!--//endExtract-->

                      <!--startFlatten-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'flatten'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>

                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-type-search-select"
                             tabindex="2"
                             [ngClass]="{'ddp-selected':isColumnListShow}"
                             [class.ddp-result]="ruleVO.col"
                             (click)="showColumnList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, filteredFlattenList, 'flatten')">
                          <input type="text" class="ddp-input-selectbox columnSearch" placeholder="{{'msg.dp.ui.column.search.description' | translate}}" [(ngModel)]="unnestSearchText">
                          <span class="ddp-txt-selectbox">{{ruleVO.col ? ruleVO.col : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isColumnListShow" (clickOutside)="isColumnListShow = false;unnestSearchText='';initSelectedCommand(filteredUnnestList);">
                            <li *ngFor="let col of filteredFlattenList; let index = index"
                                (click)="selectColumn($event, col)"
                                (mouseover)="listMouseOver($event, 'flatten', index)"
                                (mouseout)="listMouseOut($event, 'flatten')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="col.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{col.name}}
                              </a>
                            </li>
                            <li *ngIf="filteredFlattenList.length === 0">
                              <span class="ddp-noresult">
                                {{'msg.dp.ui.search.no.rslt' | translate}}
                              </span>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->
                      <!--//endFlatten-->

                      <!--startMerge-->
                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'merge'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)" tabindex="2">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox ddp-type-number">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox">{{col.seq}}</i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'merge'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.merge.delim' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- info -->
                        <div class="ddp-ui-info">
                          <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                          <div class="ddp-box-info">
                            {{'msg.dp.ui.merge.delim.tooltip' | translate}}
                          </div>
                        </div>
                        <!-- //info -->

                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic"  tabindex="3" placeholder="{{'msg.dp.ui.merge.delim.ph' | translate}}" [(ngModel)]="ruleVO.with">
                        </div>
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'merge'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.new-column-name' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- info -->
                        <div class="ddp-ui-info">
                          <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                          <div class="ddp-box-info">
                            {{'msg.dp.ui.merge.col.tooltip' | translate}}
                          </div>
                        </div>
                        <!-- //info -->
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="4" placeholder="{{'msg.dp.th.new-column-name.ph' | translate}}" [(ngModel)]="ruleVO.as">
                        </div>
                      </div>
                      <!-- //part -->
                      <!--//endMerge-->

                      <!--startAggregate-->

                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'aggregate'">
                        <div class="ddp-box-title">
                          <span class="ddp-box-title-in">
                              {{'msg.dp.th.formula' | translate}}<em class="ddp-icon-essential"></em>
                              <a href="javascript:" class="ddp-btn-plus" (click)="pivotFormulaValueList.push(''); pivotFormulaList.push('');"></a>
                          </span>
                        </div>

                        <!-- box scroll -->
                        <div class="ddp-wrap-box-info"[ngClass]="{'ddp-selected':isFocus}" >
                          <!-- info box 잠시 숨김 -->
                          <!--
                          <div class="ddp-box-info">
                            <div class="ddp-box-info-in">
                              <span class="ddp-input-title">{{'msg.dp.ui.tooltip.edit.pattern' | translate}}</span>
                              Choose an aggregation function to apply<br>

                              <strong class="ddp-ex">{{'msg.dp.ui.examples' | translate}}</strong>
                              sum(columnName)<br>
                              max(columnName)<br>
                              avg(columnName)<br>
                              count()<br>
                            </div>
                          </div>
                          -->
                          <div class="ddp-wrap-boxwrap">
                            <div class="ddp-wrap-boxadd" *ngFor="let item of pivotFormulaList; let idx = index">

                              <div class="ddp-wrap-datainput">
                                <div class="ddp-wrap-input-info" [ngClass]="{'ddp-selected':isFocus}" (clickOutside)="isAutoCompleteSuggestionListOpen=false">
                                  <input type="text" id="rule-aggregate-input-{{idx}}" tabindex="2" class="ddp-input-typebasic" placeholder="{{'msg.dp.th.formula.ph' | translate}}" [(ngModel)]="pivotFormulaValueList[idx]" (focus)="isFocus=true;changeRule($event)" (blur)="isFocus=false" (click)="changeRule($event)" (keydown)="changeRule($event)" (paste)="changeRule($event)">
                                  <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isAutoCompleteSuggestionListOpenPivot('rule-aggregate-input',idx)" >
                                    <li *ngFor="let item_sug of autoCompleteSuggestions;let idx_sug=index" (click)="onautoCompleteSuggestionsSelectPivot(item_sug,pivotFormulaValueList,idx)">
                                      <a [ngStyle]="idx_sug==autoCompleteSuggestions_selectedIdx?{'background-color':'#f6f6f7','color':item_sug.class}:{'color':item_sug.class}" href="javascript:">
                                        {{item_sug.value}}
                                      </a>
                                    </li>
                                    <li *ngIf="autoCompleteSuggestions.length === 0">
                                      <span class="ddp-noresult">
                                        {{'msg.dp.ui.search.no.rslt' | translate}}
                                      </span>
                                    </li>
                                  </ul>
                                </div>
                              </div>

                              <div class="ddp-ui-buttons">
                                <a href="javascript:" class="ddp-btn-minus" (click)="deleteFormula(idx)"></a>
                              </div>
                            </div>
                          </div>
                        </div>

                      </div>
                      <!--//part-->
                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'aggregate'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.group.by' | translate}}<em class="ddp-icon-essential"></em>
                        </div>

                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)" tabindex="3">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox ddp-type-number">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox">{{col.seq}}</i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>

                        <!-- //select box -->
                      </div>
                      <!--//part-->
                      <!--//endAggregate-->

                      <!--startSort-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'sort'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-selected" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)" tabindex="2">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox"></i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'sort'">
                        <div class="ddp-box-title">
                          Sort by<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox" tabindex="2"
                             [ngClass]="{'ddp-selected':isTypeListShow}"
                             [class.ddp-result]="ruleVO.type"
                             (click)="showTypeList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, sortList, 'type')">
                          <span class="ddp-txt-selectbox">{{ruleVO.type ? ruleVO.type : sortList[0].name}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isTypeListShow" (clickOutside)="isTypeListShow = false; initSelectedCommand(sortList)">
                            <li *ngFor="let type of sortList; let index=index"
                                (click)="setColumnType($event, type)"
                                (mouseover)="listMouseOver($event, 'sort', index)"
                                (mouseout)="listMouseOut($event, 'sort')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="type.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{type.name}}
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>

                      <!--//endSort-->


                      <!--startMove-->
                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'move'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-selected" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox"></i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->

                      <!--part-->
                      <div class="ddp-box-part" style="width : 300px" *ngIf="ruleVO.command === 'move'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.move' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- info -->
                        <div class="ddp-ui-info">
                          <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                          <div class="ddp-box-info">
                            {{'msg.dp.ui.move.tooltip' | translate}}
                          </div>
                        </div>
                        <!-- //info -->
                        <div class="ddp-type-multi">

                          <!-- select box -->
                          <!-- 클릭시 ddp-selected 추가 -->
                          <div class="ddp-type-selectbox ddp-size-s" tabindex="3" style="width : 77px" [ngClass]="{'ddp-selected':isBeforeOrAfterShow}" (click)="showBeforeOrAfterList($event)" (keydown)="navigateWithKeyboardShortList($event, moveList, 'move')">
                            <span class="ddp-txt-selectbox">{{ruleVO.beforeOrAfter === 'before' ? 'before' : 'after'}}</span>
                            <ul class="ddp-list-selectbox ddp-list-command"  *ngIf="isBeforeOrAfterShow" (clickOutside)="isBeforeOrAfterShow = false; initSelectedCommand(moveList)">
                              <li *ngFor="let item of moveList; let index = index"
                                  (click)="setBeforeOrAfter($event, item)"
                                  (mouseover)="listMouseOver($event, 'move', index)"
                                  (mouseout)="listMouseOut($event, 'move')"
                                  (mousemove)="flag === true ? flag = false : flag = true">
                                <a href="javascript:" [ngStyle]="item.isHover ? {'background-color': '#f6f6f7' }:{}">
                                  {{item.name}}
                                </a>
                              </li>
                            </ul>
                          </div>
                          <!-- //select box -->
                          <!-- select box -->
                          <!-- 클릭시 ddp-selected 추가 -->
                          <div class="ddp-type-selectbox ddp-type-search-select ddp-size-m" style="width : 200px"
                               tabindex="4"
                               [ngClass]="{'ddp-selected':isBeforeOrAfterColumnListShow}"
                               [class.ddp-result]="ruleVO.colForMove"
                               (click)="showBeforeOrAfterColumnList($event)"
                               (keydown)="navigateWithKeyboardShortList($event, filteredMoveDatasetList, 'column2')">
                            <input type="text" tabindex="4"  class="ddp-input-selectbox move-search" placeholder="{{'msg.dp.ui.column.search.description' | translate}}"[(ngModel)]="moveSearchText">
                            <span class="ddp-txt-selectbox">{{ruleVO.colForMove ? ruleVO.colForMove : 'msg.dp.ui.none.selected' | translate }}</span>
                            <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isBeforeOrAfterColumnListShow" (clickOutside)="isBeforeOrAfterColumnListShow = false; moveSearchText ='';initSelectedCommand(filteredMoveDatasetList);">
                              <li *ngFor="let col of filteredMoveDatasetList; let index = index;"
                                  (click)="selectedBeforeOrAfterColumn($event, col)"
                                  (mouseover)="listMouseOver($event, 'column2', index)"
                                  (mouseout)="listMouseOut($event, 'column2')"
                                  (mousemove)="flag === true ? flag = false : flag = true">
                                <a href="javascript:" [ngStyle]="col.isHover ? {'background-color': '#f6f6f7' }:{}">
                                  {{col.name}}
                                </a>
                              </li>
                              <li *ngIf="filteredMoveDatasetList.length === 0">
                                <span class="ddp-noresult">
                                {{'msg.dp.ui.search.no.rslt' | translate}}
                              </span>
                              </li>
                            </ul>
                          </div>
                          <!-- //select box -->
                        </div>
                      </div>
                      <!--//part-->
                      <!--//endMove-->

                      <!--start pivot -->
                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'pivot'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>

                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox ddp-type-number">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox">{{col.seq}}</i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->

                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'pivot'">
                        <div class="ddp-box-title">
                          <span class="ddp-box-title-in">
                              {{'msg.dp.th.formula' | translate}}<em class="ddp-icon-essential"></em>
                              <a href="javascript:" class="ddp-btn-plus" (click)="pivotFormulaValueList.push(''); pivotFormulaList.push('');"></a>
                          </span>
                        </div>
                        <div class="ddp-wrap-box-info"[ngClass]="{'ddp-selected':isFocus}">
                          <!-- info box 잠시 숨김 -->
                          <!--
                          <div class="ddp-box-info">
                            <div class="ddp-box-info-in">
                              <span class="ddp-input-title">{{'msg.dp.ui.tooltip.edit.pattern' | translate}}</span>
                              Choose an aggregation function to apply<br>

                              <strong class="ddp-ex">{{'msg.dp.ui.examples' | translate}}</strong>
                              sum(columnName)<br>
                              max(columnName)<br>
                              avg(columnName)<br>
                              count()<br>
                            </div>
                          </div>
                          -->
                          <!--box scroll -->
                          <div class="ddp-wrap-boxwrap">

                            <div class="ddp-wrap-boxadd" *ngFor="let item of pivotFormulaList; let idx = index">
                              <div class="ddp-wrap-datainput">
                                <div class="ddp-wrap-input-info" [ngClass]="{'ddp-selected':isFocus}" (clickOutside)="isAutoCompleteSuggestionListOpen=false">
                                  <input type="text" id="rule-pivot-input-{{idx}}" class="ddp-input-typebasic" tabindex="3" placeholder="{{'msg.dp.alert.insert.formula' | translate}}" [(ngModel)]="pivotFormulaValueList[idx]" (focus)="isFocus=true;changeRule($event)" (blur)="isFocus=false" (click)="changeRule($event)" (keydown)="changeRule($event)" (paste)="changeRule($event)">
                                  <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isAutoCompleteSuggestionListOpenPivot('rule-pivot-input',idx)" >
                                    <li *ngFor="let item_sug of autoCompleteSuggestions;let idx_sug=index" (click)="onautoCompleteSuggestionsSelectPivot(item_sug,pivotFormulaValueList,idx)">
                                      <a [ngStyle]="idx_sug==autoCompleteSuggestions_selectedIdx?{'background-color':'#f6f6f7','color':item_sug.class}:{'color':item_sug.class}" href="javascript:">
                                        {{item_sug.value}}
                                      </a>
                                    </li>
                                    <li *ngIf="autoCompleteSuggestions.length === 0">
                                      <span class="ddp-noresult">
                                        {{'msg.dp.ui.search.no.rslt' | translate}}
                                      </span>
                                    </li>
                                  </ul>
                                </div>
                              </div>

                              <div class="ddp-ui-buttons">
                                <a href="javascript:" class="ddp-btn-minus" (click)="deleteFormula(idx)"></a>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--//part-->

                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'pivot'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.group.by' | translate}}<em class="ddp-icon-essential"></em>
                        </div>

                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox" [ngClass]="{'ddp-selected':isMultiColumnGroupListShow}" (click)="showMultiColumnGroupList($event)" tabindex="4">
                          <span class="ddp-txt-selectbox">{{ruleVO.groups.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.groups.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnGroupListShow" (clickOutside)="isMultiColumnGroupListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox ddp-type-number">
                                  <input type="checkbox" [(ngModel)]="col.ticked" (change)="setGroupColSeq(col);">
                                  <i class="ddp-icon-checkbox">{{col.groupSeq}}</i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->

                      <!-- end pivot -->

                      <!--start unpivot -->
                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'unpivot'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox ddp-type-number">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox">{{col.seq}}</i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'unpivot'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.group.every' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- info -->
                        <div class="ddp-ui-info">
                          <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                          <div class="ddp-box-info">
                            {{'msg.dp.ui.unpivot.tooltip' | translate}}
                          </div>
                        </div>
                        <!-- //info -->

                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="3" placeholder="{{'msg.dp.ui.sel.col.num' | translate}}" [input-mask]="'number'" [(ngModel)]="ruleVO.groupEvery">
                        </div>
                      </div>
                      <!-- //part -->
                      <!--//endUnpivot-->

                      <!--startNest-->
                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'nest'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)" tabindex="2">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of selectedDataSet.gridData.fields">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox ddp-type-number">
                                  <input type="checkbox" [checked]="col.selected"  (click)="checkItem(col)">
                                  <i class="ddp-icon-checkbox">{{col.seq}}</i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->

                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'nest'">
                        <div class="ddp-box-title">
                          {{'msg.comm.th.type' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox" tabindex="3"
                             [ngClass]="{'ddp-selected':isNestListShow}"
                             (click)="showNestList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, nestList, 'nest')">
                          <span class="ddp-txt-selectbox">{{ruleVO.into ? ruleVO.into : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isNestListShow" (clickOutside)="isNestListShow = false; initSelectedCommand(nestList)">
                            <li *ngFor="let item of nestList; let index = index"
                                (click)="selectType($event, item)"
                                (mouseover)="listMouseOver($event, 'nest', index)"
                                (mouseout)="listMouseOut($event, 'nest')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="item.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{item.name}}
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'nest'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.new-column-name' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- info -->
                        <div class="ddp-ui-info">
                          <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                          <div class="ddp-box-info">
                            {{'msg.dp.ui.nest.tooltip' | translate}}
                          </div>
                        </div>
                        <!-- //info -->

                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="4" placeholder="{{'msg.dp.th.new-column-name.ph' | translate}}" [(ngModel)]="ruleVO.as">
                          <!-- ddp-selected 추가시 display:block; -->
                        </div>
                      </div>
                      <!-- //part -->
                      <!--//endNest-->

                      <!--startUnnest-->
                      <!--part-->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'unnest'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-type-search-select"
                             [class.ddp-result]="ruleVO.col"
                             tabindex="2"
                             [ngClass]="{'ddp-selected':isColumnListShow}"
                             (click)="showColumnList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, filteredUnnestList, 'unnestList')">
                          <input type="text" class="ddp-input-selectbox unnest-search" placeholder="{{'msg.dp.ui.column.search.description' | translate}}"[(ngModel)]="unnestSearchText">
                          <span class="ddp-txt-selectbox">{{ruleVO.col ? ruleVO.col : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isColumnListShow" (clickOutside)="isColumnListShow = false; unnestSearchText=''; initSelectedCommand(filteredUnnestList);">
                            <li *ngFor="let col of filteredUnnestList; let index = index;" (click)="selectColumn($event, col)"
                                (mouseover)="listMouseOver($event, 'unnest', index)"
                                (mouseout)="listMouseOut($event, 'unnest')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="col.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{col.name}}
                              </a>
                            </li>
                            <li *ngIf="filteredUnnestList.length === 0">
                              <span class="ddp-noresult">
                                {{'msg.dp.ui.search.no.rslt' | translate}}
                              </span>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!--//part-->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'unnest'">
                        <div class="ddp-box-title">
                          {{'msg.dp.th.sel.elements' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- info -->
                        <div class="ddp-ui-info">
                          <em class="ddp-icon-sinfo2" (mouseover)="isTooltipShow=true"  (mouseout)="isTooltipShow=false"></em>
                          <div class="ddp-box-info">
                            {{'msg.dp.ui.unnest.tooltip' | translate}}
                          </div>
                        </div>
                        <!-- //info -->

                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic" tabindex="3" placeholder="{{'msg.dp.ui.unnest.ph' | translate}}" [(ngModel)]="ruleVO.idx">
                        </div>
                      </div>
                      <!-- //part -->
                      <!--//endUnnest-->


                      <!--startSetformat-->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'setformat'">
                        <div class="ddp-box-title">
                          {{'msg.lineage.ui.list.search.column' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <div class="ddp-type-selectbox ddp-selected" tabindex="2" [ngClass]="{'ddp-selected':isMultiColumnListShow}" (click)="showMultiColumnList($event)">
                          <span class="ddp-txt-selectbox">{{ruleVO.cols.length === 0 ? ('msg.dp.ui.none.selected' | translate) : ruleVO.cols.join(',') }}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isMultiColumnListShow" (clickOutside)="isMultiColumnListShow = false;">
                            <li *ngFor="let col of filteredTimestampList">
                              <a href="javascript:">
                                <label class="ddp-label-checkbox">
                                  <input type="checkbox" [checked]="col.selected"  (click)="isTimestampEdit=false;checkItem(col)">
                                  <i class="ddp-icon-checkbox"></i>
                                  <span class="ddp-txt-checkbox">{{col.name}}</span>
                                </label>
                              </a>
                            </li>
                            <li *ngIf="filteredTimestampList.length === 0">
                              <span class="ddp-noresult">{{'msg.dp.ui.search.no.rslt' | translate}}</span>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->

                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'setformat'" style = "width :260px">
                        <div class="ddp-box-title">
                          {{'msg.dp.ui.set.pattern' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <!-- select box -->
                        <!-- 클릭시 ddp-selected 추가 -->
                        <div class="ddp-type-selectbox ddp-type-search-select" tabindex="4"
                             [ngClass]="{'ddp-selected':isTimestampOpen}"
                             [class.ddp-result]="ruleVO.timestamp"
                             (click)="isTimestampEdit=false; showTimestampList($event)"
                             (keydown)="navigateWithKeyboardShortList($event, timestampTime, 'timestamp')">
                          <span class="ddp-txt-selectbox">{{ruleVO.timestamp ? ruleVO.timestamp : 'msg.dp.ui.none.selected' | translate}}</span>
                          <ul class="ddp-list-selectbox ddp-list-command" *ngIf="isTimestampOpen" (clickOutside)="isTimestampOpen = false; typeSearchText = ''; initSelectedCommand(timestampTime);">
                            <li *ngFor="let time of timestampTime; let index=index"
                                (click)="setTimestamp($event, time)"
                                (mouseover)="listMouseOver($event, 'timestamp', index)"
                                (mouseout)="listMouseOut($event, 'timestamp')"
                                (mousemove)="flag === true ? flag = false : flag = true">
                              <a href="javascript:" [ngStyle]="time.isHover ? {'background-color': '#f6f6f7' }:{}">
                                {{time.name}}
                              </a>
                            </li>
                          </ul>
                        </div>
                        <!-- //select box -->
                      </div>
                      <!-- //part -->
                      <!-- part -->
                      <div class="ddp-box-part" *ngIf="ruleVO.command === 'setformat' && ruleVO.timestamp === 'Custom format'">
                        <div class="ddp-box-title">
                          {{'msg.dp.ui.custom.format' | translate}}<em class="ddp-icon-essential"></em>
                        </div>
                        <div class="ddp-wrap-datainput">
                          <input type="text" class="ddp-input-typebasic newColumnInput" tabindex="5" placeholder="{{'msg.dp.ui.timestamp.ph' | translate}}" [(ngModel)]="timestampVal">
                        </div>
                      </div>
                      <!-- //part -->
                      <!--endSetformat-->
                    </div>
                  </div>
                  <!-- //builder -->
                </div>
              </div>

            </div>

          </div>
        </div>
        <div class="split-pane-content-primary" style="width:100%; height:100%;">
          <div class="upper" style="width:100%; height:100%;">

            <vertical-split-pane primary-component-minsize="35" secondary-component-minsize="35" separator-thickness="7"  primary-component-initialratio="0.8" style="background:red;">
              <!--(on-change)="onVChange($event)"-->
              <div class="split-pane-content-primary" style="height:100%;">
                <div class="left" style="height:100%;">
                  <div class="ddp-wrap-flow-grid" style="position:relative; top:0; left:0; right:0; min-height:100%;">
                    <!-- option -->
                    <div class="ddp-wrap-grid-option ddp-clear">
                      <!-- left -->
                      <div class="ddp-part-left">
                        <!-- search -->
                        <div class="ddp-form-search">
                          <em class="ddp-icon-search"></em>
                          <input type="text" placeholder="Search data"
                                 id="gridSearch"
                                 [(ngModel)]="searchText"
                                 (keyup.enter)="updateGrid(this.selectedDataSet.gridData);"
                                 (keyup.esc)="searchText = ''; updateGrid(this.selectedDataSet.gridData);">
                          <em class="ddp-btn-search-close" *ngIf="searchText" (click)="searchText = ''; updateGrid(this.selectedDataSet.gridData);"></em>
                        </div>
                        <!-- //search -->
                      </div>
                      <!-- //left -->
                      <!-- right -->
                      <div class="ddp-part-right">
                        <div class="ddp-data-form ddp-cursor" (click)="isGridTypeViewList()" (clickOutside)="isGridTypeViewList(false);">
                          <strong >{{pivoteGridColumn | numberCommas}}</strong>
                          {{'msg.comm.detail.columns' | translate}}
                          <!-- 팝업 -->
                          <div class="ddp-wrap-popup2 ddp-types" *ngIf="pivotGridShowToggle == true" >
                            <ul class="ddp-list-popup">
                              <li *ngFor="let item of pivotGridTypeList">
                                <a href="javascript:">
                                  {{item}}
                                </a>
                              </li>

                            </ul>
                          </div>
                          <!-- //팝업 -->
                        </div>
                        <div class="ddp-data-form">
                          <strong>{{pivotGridTotalRow | numberCommas}}</strong>
                          {{'msg.comm.detail.rows' | translate}}
                        </div>
                        <div class="ddp-data-form">
                          <strong >{{pivotGridTypeNumber | numberCommas}}</strong>
                          {{'msg.comm.detail.types' | translate}}

                        </div>
                      </div>
                      <!-- //right -->
                    </div>
                    <!-- //option -->
                    <!-- 그리드 영역 -->
                    <div [hidden]="viewMode === 'table'"
                         class="ddp-box-gridarea"
                         grid-component
                         style="width:100%; height: 100%;"
                         (selectedHeaderMenuEvent)="selectedFromHeaderMenu($event)"
                         (selectedHeaderEvent)="gridHeaderClickHandler($event)"
                         (selectedEvent)="gridRowClickHandler($event)"
                         (onColumnResize)="drawChart($event)"
                         (onContextMenuClick)="onContextMenuClick($event)"
                         (onHeaderRowCellRendered)="onHeaderRowCellRendered($event)"></div>
                    <!-- //그리드 영역 -->
                    <div *ngIf="barChartTooltipShow"
                         [style.left]="barChartTooltipPosition"
                         class="ddp-ui-tooltip-info"
                         style="display:block;position:fixed;top: 145px;">
                      <em class="ddp-icon-view-top" style="left : 7%"></em>
                      {{barChartTooltipValue}} {{barChartTooltipLabel}} {{barChartTooltipValue == 0 ? 'value' : 'values'}}
                    </div>
                  </div>
                </div>
              </div>
              <div class="split-pane-content-secondary" style="height:100%;">
                <div class="right" style="height:100%;">
                  <!-- Rule list -->
                  <app-rule-list [ruleList]="ruleList"
                                 [redoable]="redoable"
                                 [undoable]="undoable"
                                 (jumpEvent)="jump($event)"
                                 (redoEvent)="redoRule()"
                                 (undoEvent)="undoRule()"
                                 (deleteEvent)="deleteRule($event)"
                                 (editEvent)="setRuleVO($event)">
                  </app-rule-list>
                  <!-- // Rule list -->
                </div>
              </div>
            </vertical-split-pane>
          </div>
        </div>
      </horizontal-split-pane>
    </div>
    <style>
      .upper-component {height:calc(70% - 4px) !important;}
      .lower-component {height:calc(30% - 7px) !important;}
      .invisible-extension {position:absolute; top:0; left:0; right:0; bottom:0; background-color:red;}
    </style>
  </div>

</div>
<create-snapshot-popup></create-snapshot-popup>

<!--<app-rule-join-popup [existingDataSet]="selectedDataSet"-->
                     <!--(joinComplete)="ruleJoinComplete($event);"-->
                     <!--*ngIf="isRuleJoinModalShow"-->
                     <!--[dataflow]="dataflow"-->
                     <!--[rightDataset]="rightDataset">-->
<!--</app-rule-join-popup>-->

<!--<app-rule-union-popup [masterDataset]="selectedDataSet"-->
                      <!--[dataflow]="dataflow"-->
                      <!--[isUpdate]="isUpdate"-->
                      <!--[editRuleStr]="editJoinOrUnionRuleStr"-->
                      <!--(unionComplete)="ruleUnionComplete($event);"-->
                      <!--*ngIf="isRuleUnionModalShow">-->
<!--</app-rule-union-popup>-->

<!--<multicolumn-rename (renameEvent)="applyMulticolumnRename($event)"></multicolumn-rename>-->
<!--<app-rule-context-menu (applyRuleEvent)="applyRuleFromContextMenu($event)"></app-rule-context-menu>-->
<!--<app-extend-input-formula (done)="doneInputFormula($event)"></app-extend-input-formula>-->
