<!--
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!-- tab contents -->
<div class="ddp-ui-tab-contents">
  <!-- column option -->
  <div class="ddp-option-column">

    <a href="javascript:" class="ddp-reset" (click)="onClickRestore()">
      <em class="ddp-btn-reset3"> </em>
      {{'msg.metadata.ui.codetable.detail.restore.btn' | translate}}
      <!-- tooltip -->
      <div class="ddp-ui-tooltip-info" >
        <em class="ddp-icon-view-top"></em>
        {{'msg.metadata.ui.codetable.detail.restore.btn' | translate}}
      </div>
      <!-- //tooltip -->
    </a>

    <a href="javascript:" class="ddp-btn-pop ddp-bg-black" [class.ddp-disabled]="!isEnableSave()" (click)="onClickSave()">{{'msg.comm.btn.save' | translate}}</a>
  </div>
  <!-- //column option -->
  <div class="ddp-data-details ddp-ui-preview-contents" (scroll)="onScrollColumnView()">
    <!-- header -->
    <table class="ddp-table-form ddp-table-type2 ddp-table-details ddp-type-input">
      <colgroup>
        <col width="160px">
        <col width="180px">
        <col width="180px">
        <col width="150px">
        <col width="150px">
        <col width="200px">
        <col width="150px">
        <col width="300px">
      </colgroup>
      <thead>
      <tr>
        <th class="ddp-cursor" (click)="onClickSort('popularity')">
          <div class="ddp-th-long">
            <div class="ddp-th-icons">
              <div class="ddp-wrap-hover-info">
                <em class="ddp-icon-info3"></em>
                <!-- popup -->
                <div class="ddp-box-layout4 ddp-popularity">
                  <div class="ddp-data-title">
                    {{'msg.metadata.th.column.popularity.tooltip.title' | translate}}
                  </div>
                  <div class="ddp-data-det">
                    {{'msg.metadata.th.column.popularity.tooltip.desc' | translate}}
                    <ul>
                      <li>• {{'msg.metadata.th.column.popularity.tooltip.dashboard.conn' | translate}}
                      </li>
                    </ul>
                  </div>
                </div>
                <!-- //popup -->
              </div>
              <em class="ddp-icon-array-default2" *ngIf="selectedContentSort.key !== 'popularity' || selectedContentSort.sort === 'default'"></em>
              <em class="ddp-icon-array-asc2" *ngIf="selectedContentSort.key === 'popularity' && selectedContentSort.sort === 'asc'"></em>
              <em class="ddp-icon-array-des2" *ngIf="selectedContentSort.key === 'popularity' && selectedContentSort.sort === 'desc'"></em>
            </div>
            <span class="ddp-th-txt" title="{{'msg.metadata.th.column.popularity' | translate}}">
              {{'msg.metadata.th.column.popularity' | translate}}
            </span>
          </div>
        </th>
        <th class="ddp-cursor" (click)="onClickSort('physicalName')">
          <div class="ddp-th-long">
            <div class="ddp-th-icons">
              <em class="ddp-icon-array-default2" *ngIf="selectedContentSort.key !== 'physicalName' || selectedContentSort.sort === 'default'"></em>
              <em class="ddp-icon-array-asc2" *ngIf="selectedContentSort.key === 'physicalName' && selectedContentSort.sort === 'asc'"></em>
              <em class="ddp-icon-array-des2" *ngIf="selectedContentSort.key === 'physicalName' && selectedContentSort.sort === 'desc'"></em>
            </div>
            <span class="ddp-th-txt" title="{{'msg.metadata.th.physical.name' | translate}}">
              {{'msg.metadata.th.physical.name' | translate}}
            </span>
          </div>
        </th>
        <th class="ddp-cursor" (click)="onClickSort('name')">
          <div class="ddp-th-long">
            <div class="ddp-th-icons">
              <div class="ddp-wrap-hover-info">
                <em class="ddp-icon-info3"></em>
                <!-- popup -->
                <div class="ddp-box-layout4 ddp-popularity">
                  <div class="ddp-data-title">
                    {{'msg.metadata.th.column.logical.tooltip.title' | translate}}
                  </div>
                  <div class="ddp-data-det">
                    {{'msg.metadata.th.column.logical.tooltip.desc' | translate}}
                  </div>
                </div>
                <!-- //popup -->
              </div>
              <em class="ddp-icon-array-default2" *ngIf="selectedContentSort.key !== 'name' || selectedContentSort.sort === 'default'"></em>
              <em class="ddp-icon-array-asc2" *ngIf="selectedContentSort.key === 'name' && selectedContentSort.sort === 'asc'"></em>
              <em class="ddp-icon-array-des2" *ngIf="selectedContentSort.key === 'name' && selectedContentSort.sort === 'desc'"></em>
            </div>
            <span class="ddp-th-txt" title="{{'msg.metadata.th.name' | translate}}">
              {{'msg.metadata.th.name' | translate}}
            </span>
          </div>
        </th>
        <th>
          <div class="ddp-th-long">
            <span class="ddp-th-txt" title="{{'msg.metadata.th.dictionary' | translate}}">
              {{'msg.metadata.th.dictionary' | translate}}
            </span>
          </div>
        </th>
        <th>
          <div class="ddp-th-long">
            <span class="ddp-th-txt" title="{{'msg.metadata.th.logical.type'| translate}}">
              {{'msg.metadata.th.logical.type'| translate}}
            </span>
          </div>
        </th>
        <th>
          <div class="ddp-th-long">
            <span class="ddp-th-txt" title="{{'msg.storage.ui.th.format' | translate}}">
              {{'msg.storage.ui.th.format' | translate}}
            </span>
          </div>
        </th>
        <th>
          <div class="ddp-th-long">
            <span class="ddp-th-txt" title="{{'msg.storage.ui.th.code.table' | translate}}">
              {{'msg.storage.ui.th.code.table' | translate}}
            </span>
          </div>
        </th>
        <th>
          <div class="ddp-th-long">
            <span class="ddp-th-txt" title="{{'msg.storage.ui.th.description' | translate}}">
              {{'msg.storage.ui.th.description' | translate}}
            </span>
          </div>
        </th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let column of columnList; let i = index">
        <!-- 인기도 -->
        <td class="">
          <div class="ddp-bar">
            <span [ngStyle]="{'width': getColumnPopularity(column)}"></span>
          </div>
        </td>
        <!-- //인기도 -->
        <!-- 물리 컬럼 명 -->
        <td class="ddp-disabled">
          {{column.physicalName}}
        </td>
        <!-- //물리 컬럼 명 -->
        <!-- 논리 컬럼 명 -->
        <td class="ddp-padding-none">
          <div class="ddp-input-form">
            <input type="text" class="ddp-txt-input"
                   [ngModel]="column.name"
                   (ngModelChange)="column.name = $event; column.nameChangeFl = true; column.replaceFl = true">
            <em class="ddp-bg-select"></em>
          </div>
        </td>
        <!-- //논리 컬럼 명 -->
        <!-- Dictionary -->
        <td>
          <div class="ddp-select-search ddp-hover-tooltip">
            <a href="javascript:" class="ddp-ui-search2" (click)="onClickDictionary(column.dictionary)">
              {{column.dictionary ? column.dictionary.logicalName : ''}}
              <span class="ddp-icon-search" (click)="onClickSearchDictionary(column)"></span>
            </a>
          </div>
          <div class="ddp-ui-tooltip-info " style="display:;" *ngIf="column.dictionary">
            <em class="ddp-icon-view-top"></em>{{column.dictionary.logicalName}}
          </div>
        </td>
        <!-- //Dictionary -->
        <!-- logical type -->
        <td class="ddp-inherit" [class.ddp-disabled]="isSelectedDictionary(column)">
          <!-- select -->
          <div class="ddp-ui-selected-option ddp-pop-select"
               #logicalType
               (clickOutside)="column.typeListFl = false"
               (click)="onShowLogicalTypeList(column, i)"
               [class.ddp-selected]="column.typeListFl">
                <span class="ddp-link-text ddp-txt-icon">
                  <em class="{{getFieldTypeIconClass(column.type)}}"></em>
                  {{getSelectedLogicalTypeLabel(column)}}
                  <span class="ddp-wrap-icons"></span>
                </span>
            <div class="ddp-wrap-popup2 ddp-types ddp-scroll-none ddp-pop-fix" #logicalTypeList>
              <ul class="ddp-list-popup">
                <li [class.ddp-selected]="isSelectedLogicalType(column, 'STRING')">
                  <a href="javascript:" (click)="onChangeLogicalType(column, 'STRING')">
                    <em class="ddp-icon-type-ab"></em>
                    {{'msg.metadata.ui.dictionary.type.string' | translate}}
                    <em class="ddp-icon-check"></em>
                  </a>
                </li>
                <li [class.ddp-selected]="isSelectedLogicalType(column, 'BOOLEAN')">
                  <a href="javascript:" (click)="onChangeLogicalType(column,  'BOOLEAN')">
                    <em class="ddp-icon-type-tf"></em>
                    {{'msg.metadata.ui.dictionary.type.boolean' | translate}}
                    <em class="ddp-icon-check"></em>
                  </a>
                </li>
                <li [class.ddp-selected]="isSelectedLogicalType(column, 'INTEGER')">
                  <a href="javascript:" (click)="onChangeLogicalType(column, 'INTEGER')">
                    <em class="ddp-icon-type-int"></em>
                    {{'msg.metadata.ui.dictionary.type.integer' | translate}}
                    <em class="ddp-icon-check"></em>
                  </a>
                </li>
                <li [class.ddp-selected]="isSelectedLogicalType(column, 'DOUBLE')">
                  <a href="javascript:" (click)="onChangeLogicalType(column, 'DOUBLE')">
                    <em class="ddp-icon-type-float"></em>
                    {{'msg.metadata.ui.dictionary.type.double' | translate}}
                    <em class="ddp-icon-check"></em>
                  </a>
                </li>
                <li [class.ddp-selected]="isSelectedLogicalType(column, 'TIMESTAMP')">
                  <a href="javascript:" (click)="onChangeLogicalType(column, 'TIMESTAMP')">
                    <em class="ddp-icon-type-calen"></em>
                    {{'msg.metadata.ui.dictionary.type.timestamp' | translate}}
                    <em class="ddp-icon-check"></em>
                  </a>
                </li>
              </ul>
              <ul class="ddp-list-popup">
                <li [class.ddp-selected]="isSelectedLogicalType(column, 'LNT')">
                  <a href="javascript:" (click)="onChangeLogicalType(column, 'LNT')">
                    <em class="ddp-icon-type-latitude"></em>
                    {{'msg.metadata.ui.dictionary.type.latitude' | translate}}
                    <em class="ddp-icon-check"></em>
                  </a>
                </li>
                <li [class.ddp-selected]="isSelectedLogicalType(column, 'LNG')">
                  <a href="javascript:" (click)="onChangeLogicalType(column, 'LNG')">
                    <em class="ddp-icon-type-longitude"></em>
                    {{'msg.metadata.ui.dictionary.type.longitude' | translate}}
                    <em class="ddp-icon-check"></em>
                  </a>
                </li>
              </ul>
            </div>
            <!-- //popup -->
          </div>
          <!-- //select -->
        </td>
        <!-- //logical type -->
        <!-- Format -->
        <td [class.ddp-padding-none]="!isSelectedDictionary(column)" [class.ddp-disabled]="isSelectedDictionary(column)">
          <span *ngIf="isTimeType(column) && isSelectedDictionary(column)">{{column.dictionary.format.format}}</span>
          <div class="ddp-input-form" *ngIf="isTimeType(column) && !isSelectedDictionary(column) && column.format">
            <input type="text" class="ddp-txt-input"
                   [ngModel]="column.format.format"
                   (ngModelChange)="column.format.format = $event; column.replaceFl = true">
            <em class="ddp-bg-select"></em>
          </div>
        </td>
        <!-- //Format -->
        <!-- Code Table -->
        <td [class.ddp-disabled]="isSelectedDictionary(column)">
          <div class=" ddp-select-search ddp-pop-select ddp-hover-tooltip"
               #codeTable
               [class.ddp-selected]="column['codeTableShowFl']"
               (clickOutside)="column['codeTableShowFl'] = false">
            <a href="javascript:" class="ddp-ui-search2" (click)="onClickCodeTable(column, i)">
              {{column.codeTable ? column.codeTable.name : ''}}
              <span class="ddp-icon-search" (click)="onClickSearchCodeTable(column)"></span>
            </a>
            <!-- hover -->
            <div class="ddp-box-layout4 ddp-pop-fix" #codeTablePreview>
              <a href="javascript:" class="ddp-btn-close" (click)="column['codeTableShowFl'] = false"></a>
              <div class="ddp-data-title">
                {{'msg.metadata.ui.codetable.choose.code.table.preview.title' | translate}}
              </div>
              <div class="ddp-data-code ddp-size" *ngIf="column.codeTable">
                <table class="ddp-table-code ddp-inherit ">
                  <colgroup>
                    <col width="90px">
                    <col width="*">
                  </colgroup>
                  <tbody>
                  <tr *ngFor="let pair of getTableCodePair(column.codeTable.id)">
                    <td>
                      <span class="ddp-txt-long">{{pair.code}}</span>
                      <!-- tooltip -->
                      <div class="ddp-ui-tooltip-info">
                        <em class="ddp-icon-view-top"></em>
                        {{pair.code}}
                      </div>
                      <!-- //tooltip -->
                    </td>
                    <td>
                      <span class="ddp-txt-long">{{pair.value}}</span>
                      <!-- tooltip -->
                      <div class="ddp-ui-tooltip-info">
                        <em class="ddp-icon-view-top"></em>
                        {{pair.value}}
                      </div>
                      <!-- //tooltip -->
                    </td>
                  </tr>
                  </tbody>
                </table>
                <a href="javascript:" class="ddp-link-detail" (click)="onClickCodeTableDetails(column.codeTable)">{{'msg.storage.btn.detail' | translate}}</a>
              </div>
            </div>
            <!-- //hover -->
          </div>
          <div class="ddp-ui-tooltip-info" *ngIf="column.codeTable && !column['codeTableShowFl']">
            <em class="ddp-icon-view-top"></em>{{column.codeTable.name}}
          </div>
        </td>
        <!-- //Code Table -->
        <!-- Description -->
        <td [class.ddp-padding-none]="!isSelectedDictionary(column)" [class.ddp-disabled]="isSelectedDictionary(column)">
          <span *ngIf="isSelectedDictionary(column)">{{column.description}}</span>
          <div class="ddp-input-form" *ngIf="!isSelectedDictionary(column)">
            <input type="text" class="ddp-txt-input"
                   [ngModel]="column.description"
                   (ngModelChange)="column.description = $event; column.replaceFl = true">
            <em class="ddp-bg-select"></em>
          </div>
        </td>
        <!-- //Description -->
      </tr>
      </tbody>
    </table>
    <!-- //header -->
  </div>
</div>
<!-- //tab contents -->
